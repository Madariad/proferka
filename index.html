<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Реакция на букву 'a'</title>
</head>
<body>
    <h1>Реакция на букву 'a'</h1>
    <div id="volume">Громкость: ...</div>
    <div id="letter">Буква: ...</div>

    <script>
      // Проверяем поддержку браузером
      if (!('webkitSpeechRecognition' in window)) {
        alert('Ваш браузер не поддерживает распознавание речи. Пожалуйста, используйте Google Chrome.');
      } else {
        // Создаем объект распознавания речи
       // Объект с действиями для каждой буквы
const actions = {
  'a': function() {
    // Действие для буквы 'a'
    console.log('Буква "a" распознана');
    document.getElementById('letter').textContent = 'Обнаружена буква: ';
  },
  // Добавьте другие буквы и соответствующие действия
};

// Функция для выполнения действия на основе распознанной буквы
function performAction(letter) {
  if (actions[letter]) {
    actionsletter; // Выполнение действия для буквы
  }
}

// Настройка распознавания речи
const recognition = new webkitSpeechRecognition();
recognition.continuous = true;
recognition.lang = 'en-US';
recognition.interimResults = false;
recognition.start();

// Обработчик результатов распознавания
recognition.onresult = function(event) {

  const last = event.results.length - 1;
  document.getElementById('letter').textContent = last;
  
  const transcript = event.results[last][0].transcript.trim().toLowerCase();

  // Проверяем каждую букву в распознанной фразе
  for (let i = 0; i < transcript.length; i++) {
    const letter = transcript[i];
    performAction(letter); // Выполняем действие для каждой буквы
  }
};




        // Запрашиваем доступ к микрофону
        navigator.mediaDevices.getUserMedia({ audio: true, video: false })
          .then((stream) => {
            const audioContext = new AudioContext();
            const analyser = audioContext.createAnalyser();
            const microphone = audioContext.createMediaStreamSource(stream);
            microphone.connect(analyser);
            analyser.fftSize = 256;
            const bufferLength = analyser.frequencyBinCount;
            const dataArray = new Uint8Array(bufferLength);

            // Функция для обновления громкости
            function updateVolume() {
              analyser.getByteFrequencyData(dataArray);

              // Вычисляем среднюю громкость
              let sum = 0;
              for(let i = 0; i < bufferLength; i++) {
                sum += dataArray[i];
              }
              let averageVolume = sum / bufferLength;

              // Обновляем значение громкости на странице
              document.getElementById('volume').textContent = 'Громкость: ' + averageVolume;

              // Повторяем функцию каждые 100 миллисекунд
              setTimeout(updateVolume, 100);
            }

            // Запускаем функцию обновления громкости
            updateVolume();
          })
          .catch((error) => {
            console.error('Ошибка при получении медиа-потока:', error);
          });
      }
    </script>
</body>
</html>
